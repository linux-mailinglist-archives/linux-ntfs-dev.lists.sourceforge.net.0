Return-Path: <linux-ntfs-dev-bounces@lists.sourceforge.net>
X-Original-To: lists+linux-ntfs-dev@lfdr.de
Delivered-To: lists+linux-ntfs-dev@lfdr.de
Received: from lists.sourceforge.net (lists.sourceforge.net [216.105.38.7])
	by mail.lfdr.de (Postfix) with ESMTPS id 6F1A03E3C6A
	for <lists+linux-ntfs-dev@lfdr.de>; Sun,  8 Aug 2021 21:06:36 +0200 (CEST)
Received: from [127.0.0.1] (helo=sfs-ml-1.v29.lw.sourceforge.com)
	by sfs-ml-1.v29.lw.sourceforge.com with esmtp (Exim 4.90_1)
	(envelope-from <linux-ntfs-dev-bounces@lists.sourceforge.net>)
	id 1mCo80-0004kZ-Sq; Sun, 08 Aug 2021 19:06:32 +0000
Received: from [172.30.20.202] (helo=mx.sourceforge.net)
 by sfs-ml-4.v29.lw.sourceforge.com with esmtps
 (TLSv1.2:ECDHE-RSA-AES256-GCM-SHA384:256) (Exim 4.90_1)
 (envelope-from <pali@kernel.org>)
 id 1mClcJ-0003PG-5S; Sun, 08 Aug 2021 16:25:39 +0000
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
 d=sourceforge.net; s=x; h=Content-Transfer-Encoding:Content-Type:MIME-Version
 :References:In-Reply-To:Message-Id:Date:Subject:To:From:Sender:Reply-To:Cc:
 Content-ID:Content-Description:Resent-Date:Resent-From:Resent-Sender:
 Resent-To:Resent-Cc:Resent-Message-ID:List-Id:List-Help:List-Unsubscribe:
 List-Subscribe:List-Post:List-Owner:List-Archive;
 bh=JgBQu7kUiTr23ZLVN1GGFlUQgvITwKwBQcyz7vJ5tUY=; b=O1Uva35IJmFjaB5NVmsSR+f5xT
 oBHIonTD8dBtp/f7tc1+KhcqhGANqKneIZKYVIJ+AfngXzoU0tYMHB70B6nB+clwLCmhDRi4kDFHs
 9bnSWyyijZWKSY8sYU9pm8je5TEBWN15B0d5YbTSgQBuxKFV3bLxe0H7+aFQbxga1zRU=;
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=sf.net; s=x
 ;
 h=Content-Transfer-Encoding:Content-Type:MIME-Version:References:
 In-Reply-To:Message-Id:Date:Subject:To:From:Sender:Reply-To:Cc:Content-ID:
 Content-Description:Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc
 :Resent-Message-ID:List-Id:List-Help:List-Unsubscribe:List-Subscribe:
 List-Post:List-Owner:List-Archive;
 bh=JgBQu7kUiTr23ZLVN1GGFlUQgvITwKwBQcyz7vJ5tUY=; b=efN7J4HfiN4MLv+WnoNMrwnZQk
 jRicwG7laOE5De4dAnIzZUAsXN3CuHUW1qfZ3wuRu0AqYUMEAOswGwcP0kAw1Ft+hhlhvkf+qMloH
 FDHk2aHRT9Df4hXcx4kDK2Kd9mrJ0anNluqsljS094P31V1XS14aK9Qw7/cZB69vlqnE=;
Received: from mail.kernel.org ([198.145.29.99])
 by sfi-mx-2.v28.lw.sourceforge.com with esmtps
 (TLSv1.2:ECDHE-RSA-AES256-GCM-SHA384:256) (Exim 4.92.3)
 id 1mClcH-0001wj-MJ; Sun, 08 Aug 2021 16:25:39 +0000
Received: by mail.kernel.org (Postfix) with ESMTPSA id 6F85D61028;
 Sun,  8 Aug 2021 16:25:19 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=k20201202; t=1628439919;
 bh=Xjiv1V1kbObBq09/duKu+NNtCwH+mfEyS1BKpAACXoo=;
 h=From:To:Subject:Date:In-Reply-To:References:From;
 b=kiYoPRKsI5tsT4xbdCejBqO3jTq5lo5wRlSzXg/xA/jNy/5SGxnS8/XnUr17EFzAl
 dOllXqmy1G7ym/6f8VQ9qOMUMpp8Omk7hW5yirERfPLUsFvqcPHKq3XxKbNvjVtJMG
 gjorDMUhCR3Uw8TTbMLnynRJiH4K4t26l4tOxjQqfMDDAl2+fRFIGbLvQdbgT9dgeL
 1jhp1j93dcAN4wL8RLUPy8loa5Ihjlfi0O4wkxWsNlkB0dm0BhuILclWbXzlKbVNnN
 Zr68+oOBNF+vwJ6ZmW4igUxxmo44XO6R1NuCk9un+xUDHcderBG7mVVOY9O329fBxN
 3/1hKzGpYyuGg==
Received: by pali.im (Postfix)
 id 2D3CC13DC; Sun,  8 Aug 2021 18:25:19 +0200 (CEST)
From: =?UTF-8?q?Pali=20Roh=C3=A1r?= <pali@kernel.org>
To: linux-fsdevel@vger.kernel.org, linux-ntfs-dev@lists.sourceforge.net,
 linux-cifs@vger.kernel.org, jfs-discussion@lists.sourceforge.net,
 linux-kernel@vger.kernel.org, Alexander Viro <viro@zeniv.linux.org.uk>,
 Jan Kara <jack@suse.cz>, OGAWA Hirofumi <hirofumi@mail.parknet.co.jp>,
 "Theodore Y . Ts'o" <tytso@mit.edu>,
 Luis de Bethencourt <luisbg@kernel.org>,
 Salah Triki <salah.triki@gmail.com>,
 Andrew Morton <akpm@linux-foundation.org>,
 Dave Kleikamp <shaggy@kernel.org>, Anton Altaparmakov <anton@tuxera.com>,
 Pavel Machek <pavel@ucw.cz>,
 =?UTF-8?q?Marek=20Beh=C3=BAn?= <marek.behun@nic.cz>,
 Christoph Hellwig <hch@infradead.org>
Date: Sun,  8 Aug 2021 18:24:46 +0200
Message-Id: <20210808162453.1653-14-pali@kernel.org>
X-Mailer: git-send-email 2.20.1
In-Reply-To: <20210808162453.1653-1-pali@kernel.org>
References: <20210808162453.1653-1-pali@kernel.org>
MIME-Version: 1.0
X-Spam-Score: -0.8 (/)
X-Spam-Report: Spam Filtering performed by mx.sourceforge.net.
 See http://spamassassin.org/tag/ for more details.
 -0.0 SPF_PASS               SPF: sender matches SPF record
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 -0.1 DKIM_VALID_AU Message has a valid DKIM or DK signature from author's
 domain
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature,
 not necessarily valid
 -0.7 DKIMWL_WL_HIGH         DKIMwl.org - High trust sender
 0.0 AWL AWL: Adjusted score from AWL reputation of From: address
X-Headers-End: 1mClcH-0001wj-MJ
X-Mailman-Approved-At: Sun, 08 Aug 2021 19:06:29 +0000
Subject: [Linux-NTFS-Dev] [RFC PATCH 13/20] hfsplus: Do not use broken utf8
 NLS table for iocharset=utf8 mount option
X-BeenThere: linux-ntfs-dev@lists.sourceforge.net
X-Mailman-Version: 2.1.21
Precedence: list
List-Id: "Discussion related to Linux NTFS development."
 <linux-ntfs-dev.lists.sourceforge.net>
List-Unsubscribe: <https://lists.sourceforge.net/lists/options/linux-ntfs-dev>, 
 <mailto:linux-ntfs-dev-request@lists.sourceforge.net?subject=unsubscribe>
List-Archive: <http://sourceforge.net/mailarchive/forum.php?forum_name=linux-ntfs-dev>
List-Post: <mailto:linux-ntfs-dev@lists.sourceforge.net>
List-Help: <mailto:linux-ntfs-dev-request@lists.sourceforge.net?subject=help>
List-Subscribe: <https://lists.sourceforge.net/lists/listinfo/linux-ntfs-dev>, 
 <mailto:linux-ntfs-dev-request@lists.sourceforge.net?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-ntfs-dev-bounces@lists.sourceforge.net

TkxTIHRhYmxlIGZvciB1dGY4IGlzIGJyb2tlbiBhbmQgY2Fubm90IGJlIGZpeGVkLgoKU28gaW5z
dGVhZCBvZiBicm9rZW4gdXRmOCBubHMgZnVuY3Rpb25zIGNoYXIydW5pKCkgYW5kIHVuaTJjaGFy
KCkgdXNlCmZ1bmN0aW9ucyB1dGY4X3RvX3V0ZjMyKCkgYW5kIHV0ZjMyX3RvX3V0ZjgoKSB3aGlj
aCBpbXBsZW1lbnRzIGNvcnJlY3QKZW5jb2RpbmcgYW5kIGRlY29kaW5nIGJldHdlZW4gVW5pY29k
ZSBjb2RlIHBvaW50cyBhbmQgVVRGLTggc2VxdWVuY2UuCgpOb3RlIHRoYXQgdGhpcyBmcyBkcml2
ZXIgZG9lcyBub3Qgc3VwcG9ydCBmdWxsIFVuaWNvZGUgcmFuZ2UsIHNwZWNpYWxseQpVVEYtMTYg
c3Vycm9nYXRlIHBhaXJzIGFyZSB1bnN1cHBvcnRlZC4gVGhpcyBwYXRjaCBkb2VzIG5vdCBjaGFu
Z2UgdGhpcwpsaW1pdGF0aW9uIGFuZCBzdXBwb3J0IGZvciBVVEYtMTYgc3Vycm9nYXRlIHBhaXJz
IHN0YXkgdW5pbXBsZW1lbnRlZC4KCldoZW4gaW9jaGF0c2V0PXV0ZjggaXMgdXNlZCB0aGVuIHNl
dCBzYmktPm5scyB0byBOVUxMIGFuZCB1c2UgaXQgZm9yCmRpc3Rpbmd1aXNoIGJldHdlZW4gdGhl
IGZhY3QgaWYgTkxTIHRhYmxlIG9yIG5hdGl2ZSBVVEYtOCBmdW5jdGlvbnMgc2hvdWxkCmJlIHVz
ZWQuCgpTaWduZWQtb2ZmLWJ5OiBQYWxpIFJvaMOhciA8cGFsaUBrZXJuZWwub3JnPgotLS0KIGZz
L2hmc3BsdXMvZGlyLmMgICAgICAgICAgICB8ICA2ICsrKystLQogZnMvaGZzcGx1cy9vcHRpb25z
LmMgICAgICAgIHwgMzIgKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0KIGZzL2hmc3Bs
dXMvc3VwZXIuYyAgICAgICAgICB8ICA3ICstLS0tLS0KIGZzL2hmc3BsdXMvdW5pY29kZS5jICAg
ICAgICB8IDMxICsrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0KIGZzL2hmc3BsdXMveGF0
dHIuYyAgICAgICAgICB8IDE0ICsrKysrKysrKy0tLS0tCiBmcy9oZnNwbHVzL3hhdHRyX3NlY3Vy
aXR5LmMgfCAgMyArKy0KIDYgZmlsZXMgY2hhbmdlZCwgNjIgaW5zZXJ0aW9ucygrKSwgMzEgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZnMvaGZzcGx1cy9kaXIuYyBiL2ZzL2hmc3BsdXMvZGly
LmMKaW5kZXggODQ3MTRiYmNjYzEyLi4yY2FmMGNkODIyMjEgMTAwNjQ0Ci0tLSBhL2ZzL2hmc3Bs
dXMvZGlyLmMKKysrIGIvZnMvaGZzcGx1cy9kaXIuYwpAQCAtMTQ0LDcgKzE0NCw4IEBAIHN0YXRp
YyBpbnQgaGZzcGx1c19yZWFkZGlyKHN0cnVjdCBmaWxlICpmaWxlLCBzdHJ1Y3QgZGlyX2NvbnRl
eHQgKmN0eCkKIAllcnIgPSBoZnNfZmluZF9pbml0KEhGU1BMVVNfU0Ioc2IpLT5jYXRfdHJlZSwg
JmZkKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4gZXJyOwotCXN0cmJ1ZiA9IGttYWxsb2MoTkxTX01B
WF9DSEFSU0VUX1NJWkUgKiBIRlNQTFVTX01BWF9TVFJMRU4gKyAxLCBHRlBfS0VSTkVMKTsKKwlz
dHJidWYgPSBrbWFsbG9jKChIRlNQTFVTX1NCKHNiKS0+bmxzID8gTkxTX01BWF9DSEFSU0VUX1NJ
WkUgOiA0KSAqCisJCQlIRlNQTFVTX01BWF9TVFJMRU4gKyAxLCBHRlBfS0VSTkVMKTsKIAlpZiAo
IXN0cmJ1ZikgewogCQllcnIgPSAtRU5PTUVNOwogCQlnb3RvIG91dDsKQEAgLTIwMyw3ICsyMDQs
OCBAQCBzdGF0aWMgaW50IGhmc3BsdXNfcmVhZGRpcihzdHJ1Y3QgZmlsZSAqZmlsZSwgc3RydWN0
IGRpcl9jb250ZXh0ICpjdHgpCiAJCWhmc19ibm9kZV9yZWFkKGZkLmJub2RlLCAmZW50cnksIGZk
LmVudHJ5b2Zmc2V0LAogCQkJZmQuZW50cnlsZW5ndGgpOwogCQl0eXBlID0gYmUxNl90b19jcHUo
ZW50cnkudHlwZSk7Ci0JCWxlbiA9IE5MU19NQVhfQ0hBUlNFVF9TSVpFICogSEZTUExVU19NQVhf
U1RSTEVOOworCQlsZW4gPSAoSEZTUExVU19TQihzYiktPm5scyA/IE5MU19NQVhfQ0hBUlNFVF9T
SVpFIDogNCkgKgorCQkgICAgICBIRlNQTFVTX01BWF9TVFJMRU47CiAJCWVyciA9IGhmc3BsdXNf
dW5pMmFzYyhzYiwgJmZkLmtleS0+Y2F0Lm5hbWUsIHN0cmJ1ZiwgJmxlbik7CiAJCWlmIChlcnIp
CiAJCQlnb3RvIG91dDsKZGlmZiAtLWdpdCBhL2ZzL2hmc3BsdXMvb3B0aW9ucy5jIGIvZnMvaGZz
cGx1cy9vcHRpb25zLmMKaW5kZXggYTk3NTU0OGY2YjkxLi4xNmMwOGNiNWM0ZjggMTAwNjQ0Ci0t
LSBhL2ZzL2hmc3BsdXMvb3B0aW9ucy5jCisrKyBiL2ZzL2hmc3BsdXMvb3B0aW9ucy5jCkBAIC0x
MDQsNiArMTA0LDkgQEAgaW50IGhmc3BsdXNfcGFyc2Vfb3B0aW9ucyhjaGFyICppbnB1dCwgc3Ry
dWN0IGhmc3BsdXNfc2JfaW5mbyAqc2JpKQogCWNoYXIgKnA7CiAJc3Vic3RyaW5nX3QgYXJnc1tN
QVhfT1BUX0FSR1NdOwogCWludCB0bXAsIHRva2VuOworCWludCBoYXZlX2lvY2hhcnNldDsKKwor
CWhhdmVfaW9jaGFyc2V0ID0gMDsKIAogCWlmICghaW5wdXQpCiAJCWdvdG8gZG9uZTsKQEAgLTE3
MSwyMCArMTc0LDI0IEBAIGludCBoZnNwbHVzX3BhcnNlX29wdGlvbnMoY2hhciAqaW5wdXQsIHN0
cnVjdCBoZnNwbHVzX3NiX2luZm8gKnNiaSkKIAkJCXByX3dhcm4oIm9wdGlvbiBubHM9IGlzIGRl
cHJlY2F0ZWQsIHVzZSBpb2NoYXJzZXQ9XG4iKTsKIAkJCS8qIGZhbGx0aHJvdWdoICovCiAJCWNh
c2Ugb3B0X2lvY2hhcnNldDoKLQkJCWlmIChzYmktPm5scykgeworCQkJaWYgKGhhdmVfaW9jaGFy
c2V0KSB7CiAJCQkJcHJfZXJyKCJ1bmFibGUgdG8gY2hhbmdlIG5scyBtYXBwaW5nXG4iKTsKIAkJ
CQlyZXR1cm4gMDsKIAkJCX0KIAkJCXAgPSBtYXRjaF9zdHJkdXAoJmFyZ3NbMF0pOwotCQkJaWYg
KHApCi0JCQkJc2JpLT5ubHMgPSBsb2FkX25scyhwKTsKLQkJCWlmICghc2JpLT5ubHMpIHsKLQkJ
CQlwcl9lcnIoInVuYWJsZSB0byBsb2FkIG5scyBtYXBwaW5nIFwiJXNcIlxuIiwKLQkJCQkgICAg
ICAgcCk7Ci0JCQkJa2ZyZWUocCk7CisJCQlpZiAoIXApCiAJCQkJcmV0dXJuIDA7CisJCQlpZiAo
c3RyY21wKHAsICJ1dGY4IikgIT0gMCkgeworCQkJCXNiaS0+bmxzID0gbG9hZF9ubHMocCk7CisJ
CQkJaWYgKCFzYmktPm5scykgeworCQkJCQlwcl9lcnIoInVuYWJsZSB0byBsb2FkIG5scyBtYXBw
aW5nICIKKwkJCQkJCSJcIiVzXCJcbiIsIHApOworCQkJCQlrZnJlZShwKTsKKwkJCQkJcmV0dXJu
IDA7CisJCQkJfQogCQkJfQogCQkJa2ZyZWUocCk7CisJCQloYXZlX2lvY2hhcnNldCA9IDE7CiAJ
CQlicmVhazsKIAkJY2FzZSBvcHRfZGVjb21wb3NlOgogCQkJY2xlYXJfYml0KEhGU1BMVVNfU0Jf
Tk9ERUNPTVBPU0UsICZzYmktPmZsYWdzKTsKQEAgLTIwNywxMyArMjE0LDEwIEBAIGludCBoZnNw
bHVzX3BhcnNlX29wdGlvbnMoY2hhciAqaW5wdXQsIHN0cnVjdCBoZnNwbHVzX3NiX2luZm8gKnNi
aSkKIAl9CiAKIGRvbmU6Ci0JaWYgKCFzYmktPm5scykgewotCQkvKiB0cnkgdXRmOCBmaXJzdCwg
YXMgdGhpcyBpcyB0aGUgb2xkIGRlZmF1bHQgYmVoYXZpb3VyICovCi0JCXNiaS0+bmxzID0gbG9h
ZF9ubHMoInV0ZjgiKTsKLQkJaWYgKCFzYmktPm5scykKLQkJCXNiaS0+bmxzID0gbG9hZF9ubHNf
ZGVmYXVsdCgpOwotCQlpZiAoIXNiaS0+bmxzKQotCQkJcmV0dXJuIDA7CisJaWYgKCFoYXZlX2lv
Y2hhcnNldCkgeworCQkvKiB1c2UgdXRmOCwgYXMgdGhpcyBpcyB0aGUgb2xkIGRlZmF1bHQgYmVo
YXZpb3VyICovCisJCXByX2RlYnVnKCJ1c2luZyBuYXRpdmUgVVRGLTggd2l0aG91dCBubHNcbiIp
OworCQkvKiBubyBzYmktPm5scyBtZWFucyB0aGF0IG5hdGl2ZSBVVEYtOCBjb2RlIGlzIHVzZWQg
Ki8KIAl9CiAKIAlyZXR1cm4gMTsKZGlmZiAtLWdpdCBhL2ZzL2hmc3BsdXMvc3VwZXIuYyBiL2Zz
L2hmc3BsdXMvc3VwZXIuYwppbmRleCBiOWUzZGIzZjg1NWYuLjk4NTY2MjQ1MWJmYyAxMDA2NDQK
LS0tIGEvZnMvaGZzcGx1cy9zdXBlci5jCisrKyBiL2ZzL2hmc3BsdXMvc3VwZXIuYwpAQCAtNDAz
LDExICs0MDMsNyBAQCBzdGF0aWMgaW50IGhmc3BsdXNfZmlsbF9zdXBlcihzdHJ1Y3Qgc3VwZXJf
YmxvY2sgKnNiLCB2b2lkICpkYXRhLCBpbnQgc2lsZW50KQogCiAJLyogdGVtcG9yYXJpbHkgdXNl
IHV0ZjggdG8gY29ycmVjdGx5IGZpbmQgdGhlIGhpZGRlbiBkaXIgYmVsb3cgKi8KIAlubHMgPSBz
YmktPm5sczsKLQlzYmktPm5scyA9IGxvYWRfbmxzKCJ1dGY4Iik7Ci0JaWYgKCFzYmktPm5scykg
ewotCQlwcl9lcnIoInVuYWJsZSB0byBsb2FkIG5scyBmb3IgdXRmOFxuIik7Ci0JCWdvdG8gb3V0
X3VubG9hZF9ubHM7Ci0JfQorCXNiaS0+bmxzID0gTlVMTDsKIAogCS8qIEdyYWIgdGhlIHZvbHVt
ZSBoZWFkZXIgKi8KIAlpZiAoaGZzcGx1c19yZWFkX3dyYXBwZXIoc2IpKSB7CkBAIC01ODUsNyAr
NTgxLDYgQEAgc3RhdGljIGludCBoZnNwbHVzX2ZpbGxfc3VwZXIoc3RydWN0IHN1cGVyX2Jsb2Nr
ICpzYiwgdm9pZCAqZGF0YSwgaW50IHNpbGVudCkKIAkJfQogCX0KIAotCXVubG9hZF9ubHMoc2Jp
LT5ubHMpOwogCXNiaS0+bmxzID0gbmxzOwogCXJldHVybiAwOwogCmRpZmYgLS1naXQgYS9mcy9o
ZnNwbHVzL3VuaWNvZGUuYyBiL2ZzL2hmc3BsdXMvdW5pY29kZS5jCmluZGV4IDczMzQyYzkyNWE0
Yi4uMWQ4YzMxYzUxMjZmIDEwMDY0NAotLS0gYS9mcy9oZnNwbHVzL3VuaWNvZGUuYworKysgYi9m
cy9oZnNwbHVzL3VuaWNvZGUuYwpAQCAtMTkwLDcgKzE5MCwxMiBAQCBpbnQgaGZzcGx1c191bmky
YXNjKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsCiAJCQkJYzAgPSAnOic7CiAJCQkJYnJlYWs7CiAJ
CQl9Ci0JCQlyZXMgPSBubHMtPnVuaTJjaGFyKGMwLCBvcCwgbGVuKTsKKwkJCWlmIChubHMpCisJ
CQkJcmVzID0gbmxzLT51bmkyY2hhcihjMCwgb3AsIGxlbik7CisJCQllbHNlIChsZW4gPiAwKQor
CQkJCXJlcyA9IHV0ZjMyX3RvX3V0ZjgoYzAsIG9wLCBsZW4pOworCQkJZWxzZQorCQkJCXJlcyA9
IC1FTkFNRVRPT0xPTkc7CiAJCQlpZiAocmVzIDwgMCkgewogCQkJCWlmIChyZXMgPT0gLUVOQU1F
VE9PTE9ORykKIAkJCQkJZ290byBvdXQ7CkBAIC0yMzMsNyArMjM4LDEyIEBAIGludCBoZnNwbHVz
X3VuaTJhc2Moc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwKIAkJCWNjID0gYzA7CiAJCX0KIGRvbmU6
Ci0JCXJlcyA9IG5scy0+dW5pMmNoYXIoY2MsIG9wLCBsZW4pOworCQlpZiAobmxzKQorCQkJcmVz
ID0gbmxzLT51bmkyY2hhcihjYywgb3AsIGxlbik7CisJCWVsc2UgKGxlbiA+IDApCisJCQlyZXMg
PSB1dGYzMl90b191dGY4KGNjLCBvcCwgbGVuKTsKKwkJZWxzZQorCQkJcmVzID0gLUVOQU1FVE9P
TE9ORzsKIAkJaWYgKHJlcyA8IDApIHsKIAkJCWlmIChyZXMgPT0gLUVOQU1FVE9PTE9ORykKIAkJ
CQlnb3RvIG91dDsKQEAgLTI1Niw3ICsyNjYsMjIgQEAgaW50IGhmc3BsdXNfdW5pMmFzYyhzdHJ1
Y3Qgc3VwZXJfYmxvY2sgKnNiLAogc3RhdGljIGlubGluZSBpbnQgYXNjMnVuaWNoYXIoc3RydWN0
IHN1cGVyX2Jsb2NrICpzYiwgY29uc3QgY2hhciAqYXN0ciwgaW50IGxlbiwKIAkJCSAgICAgIHdj
aGFyX3QgKnVjKQogewotCWludCBzaXplID0gSEZTUExVU19TQihzYiktPm5scy0+Y2hhcjJ1bmko
YXN0ciwgbGVuLCB1Yyk7CisJc3RydWN0IG5sc190YWJsZSAqbmxzID0gSEZTUExVU19TQihzYikt
Pm5sczsKKwl1bmljb2RlX3QgdTsKKwlpbnQgc2l6ZTsKKworCWlmIChubHMpCisJCXNpemUgPSBu
bHMtPmNoYXIydW5pKGFzdHIsIGxlbiwgdWMpOworCWVsc2UgeworCQlzaXplID0gdXRmOF90b191
dGYzMihhc3RyLCBsZW4sICZ1KTsKKwkJaWYgKHNpemUgPj0gMCkgeworCQkJLyogVE9ETzogQWRk
IHN1cHBvcnQgZm9yIFVURi0xNiBzdXJyb2dhdGUgcGFpcnMgKi8KKwkJCWlmICh1IDw9IE1BWF9X
Q0hBUl9UKQorCQkJCSp1YyA9IHU7CisJCQllbHNlCisJCQkJc2l6ZSA9IC1FSU5WQUw7CisJCX0K
Kwl9CiAJaWYgKHNpemUgPD0gMCkgewogCQkqdWMgPSAnPyc7CiAJCXNpemUgPSAxOwpkaWZmIC0t
Z2l0IGEvZnMvaGZzcGx1cy94YXR0ci5jIGIvZnMvaGZzcGx1cy94YXR0ci5jCmluZGV4IGUyODU1
Y2VlZmQzOS4uOWIyNjUzZjA4YTVmIDEwMDY0NAotLS0gYS9mcy9oZnNwbHVzL3hhdHRyLmMKKysr
IGIvZnMvaGZzcGx1cy94YXR0ci5jCkBAIC00MjUsNyArNDI1LDggQEAgaW50IGhmc3BsdXNfc2V0
eGF0dHIoc3RydWN0IGlub2RlICppbm9kZSwgY29uc3QgY2hhciAqbmFtZSwKIAljaGFyICp4YXR0
cl9uYW1lOwogCWludCByZXM7CiAKLQl4YXR0cl9uYW1lID0ga21hbGxvYyhOTFNfTUFYX0NIQVJT
RVRfU0laRSAqIEhGU1BMVVNfQVRUUl9NQVhfU1RSTEVOICsgMSwKKwl4YXR0cl9uYW1lID0ga21h
bGxvYygoSEZTUExVU19TQihzYiktPm5scyA/IE5MU19NQVhfQ0hBUlNFVF9TSVpFIDogNCkgKgor
CQkJICAgICBIRlNQTFVTX0FUVFJfTUFYX1NUUkxFTiArIDEsCiAJCUdGUF9LRVJORUwpOwogCWlm
ICgheGF0dHJfbmFtZSkKIAkJcmV0dXJuIC1FTk9NRU07CkBAIC01NzksNyArNTgwLDggQEAgc3Np
emVfdCBoZnNwbHVzX2dldHhhdHRyKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGNvbnN0IGNoYXIgKm5h
bWUsCiAJaW50IHJlczsKIAljaGFyICp4YXR0cl9uYW1lOwogCi0JeGF0dHJfbmFtZSA9IGttYWxs
b2MoTkxTX01BWF9DSEFSU0VUX1NJWkUgKiBIRlNQTFVTX0FUVFJfTUFYX1NUUkxFTiArIDEsCisJ
eGF0dHJfbmFtZSA9IGttYWxsb2MoKEhGU1BMVVNfU0Ioc2IpLT5ubHMgPyBOTFNfTUFYX0NIQVJT
RVRfU0laRSA6IDQpICoKKwkJCSAgICAgSEZTUExVU19BVFRSX01BWF9TVFJMRU4gKyAxLAogCQkJ
ICAgICBHRlBfS0VSTkVMKTsKIAlpZiAoIXhhdHRyX25hbWUpCiAJCXJldHVybiAtRU5PTUVNOwpA
QCAtNjk5LDggKzcwMSw5IEBAIHNzaXplX3QgaGZzcGx1c19saXN0eGF0dHIoc3RydWN0IGRlbnRy
eSAqZGVudHJ5LCBjaGFyICpidWZmZXIsIHNpemVfdCBzaXplKQogCQlyZXR1cm4gZXJyOwogCX0K
IAotCXN0cmJ1ZiA9IGttYWxsb2MoTkxTX01BWF9DSEFSU0VUX1NJWkUgKiBIRlNQTFVTX0FUVFJf
TUFYX1NUUkxFTiArCi0JCQlYQVRUUl9NQUNfT1NYX1BSRUZJWF9MRU4gKyAxLCBHRlBfS0VSTkVM
KTsKKwlzdHJidWYgPSBrbWFsbG9jKChIRlNQTFVTX1NCKHNiKS0+bmxzID8gTkxTX01BWF9DSEFS
U0VUX1NJWkUgOiA0KSAqCisJCQlIRlNQTFVTX0FUVFJfTUFYX1NUUkxFTiArIFhBVFRSX01BQ19P
U1hfUFJFRklYX0xFTiArIDEsCisJCQlHRlBfS0VSTkVMKTsKIAlpZiAoIXN0cmJ1ZikgewogCQly
ZXMgPSAtRU5PTUVNOwogCQlnb3RvIG91dDsKQEAgLTczMiw3ICs3MzUsOCBAQCBzc2l6ZV90IGhm
c3BsdXNfbGlzdHhhdHRyKHN0cnVjdCBkZW50cnkgKmRlbnRyeSwgY2hhciAqYnVmZmVyLCBzaXpl
X3Qgc2l6ZSkKIAkJaWYgKGJlMzJfdG9fY3B1KGF0dHJfa2V5LmNuaWQpICE9IGlub2RlLT5pX2lu
bykKIAkJCWdvdG8gZW5kX2xpc3R4YXR0cjsKIAotCQl4YXR0cl9uYW1lX2xlbiA9IE5MU19NQVhf
Q0hBUlNFVF9TSVpFICogSEZTUExVU19BVFRSX01BWF9TVFJMRU47CisJCXhhdHRyX25hbWVfbGVu
ID0gKEhGU1BMVVNfU0Ioc2IpLT5ubHMgPyBOTFNfTUFYX0NIQVJTRVRfU0laRSA6IDQpCisJCQkJ
KiBIRlNQTFVTX0FUVFJfTUFYX1NUUkxFTjsKIAkJaWYgKGhmc3BsdXNfdW5pMmFzYyhpbm9kZS0+
aV9zYiwKIAkJCShjb25zdCBzdHJ1Y3QgaGZzcGx1c191bmlzdHIgKikmZmQua2V5LT5hdHRyLmtl
eV9uYW1lLAogCQkJCQlzdHJidWYsICZ4YXR0cl9uYW1lX2xlbikpIHsKZGlmZiAtLWdpdCBhL2Zz
L2hmc3BsdXMveGF0dHJfc2VjdXJpdHkuYyBiL2ZzL2hmc3BsdXMveGF0dHJfc2VjdXJpdHkuYwpp
bmRleCBjMWM3YTE2Y2JmMjEuLjQzOGViY2QxMzU5YiAxMDA2NDQKLS0tIGEvZnMvaGZzcGx1cy94
YXR0cl9zZWN1cml0eS5jCisrKyBiL2ZzL2hmc3BsdXMveGF0dHJfc2VjdXJpdHkuYwpAQCAtNDEs
NyArNDEsOCBAQCBzdGF0aWMgaW50IGhmc3BsdXNfaW5pdHhhdHRycyhzdHJ1Y3QgaW5vZGUgKmlu
b2RlLAogCWNoYXIgKnhhdHRyX25hbWU7CiAJaW50IGVyciA9IDA7CiAKLQl4YXR0cl9uYW1lID0g
a21hbGxvYyhOTFNfTUFYX0NIQVJTRVRfU0laRSAqIEhGU1BMVVNfQVRUUl9NQVhfU1RSTEVOICsg
MSwKKwl4YXR0cl9uYW1lID0ga21hbGxvYygoSEZTUExVU19TQihzYiktPm5scyA/IE5MU19NQVhf
Q0hBUlNFVF9TSVpFIDogNCkgKgorCQkJICAgICBIRlNQTFVTX0FUVFJfTUFYX1NUUkxFTiArIDEs
CiAJCUdGUF9LRVJORUwpOwogCWlmICgheGF0dHJfbmFtZSkKIAkJcmV0dXJuIC1FTk9NRU07Ci0t
IAoyLjIwLjEKCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X18KTGludXgtTlRGUy1EZXYgbWFpbGluZyBsaXN0CkxpbnV4LU5URlMtRGV2QGxpc3RzLnNvdXJj
ZWZvcmdlLm5ldApodHRwczovL2xpc3RzLnNvdXJjZWZvcmdlLm5ldC9saXN0cy9saXN0aW5mby9s
aW51eC1udGZzLWRldgo=
